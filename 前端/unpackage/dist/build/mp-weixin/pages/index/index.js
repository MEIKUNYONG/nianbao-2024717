(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"434e":function(t,o,n){"use strict";n.r(o);var e=n("a4ed"),i=n("6de1");for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(o,t,(function(){return i[t]}))}(a);n("7bac");var s=n("f0c5"),c=Object(s["a"])(i["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],void 0);o["default"]=c.exports},"4e2e":function(t,o,n){"use strict";(function(t){var e=n("4ea4");Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i=e(n("9523"));function a(t,o){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);o&&(e=e.filter((function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),n.push.apply(n,e)}return n}function s(t){for(var o=1;o<arguments.length;o++){var n=null!=arguments[o]?arguments[o]:{};o%2?a(Object(n),!0).forEach((function(o){(0,i.default)(t,o,n[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))}))}return t}var c=getApp(),l={data:function(){return{isLogin:!1,isShowTip:!0,isShowExit:!1,isShowSelect:!1,config:[],logo1:"/static/img/del/logo1.png",logo2:"/static/img/del/logo2.png",miniName:"",oaUrl:"",searchText:"",isShowSearchList:!1,searchList:[],searchCompany:[],nowCompany:[],companyList:[],companyIndex:null,userInfo:[],mobile:""}},onLoad:function(){this.getConfig(),console.log(c.globalData.mobile),""==c.globalData.mobile?(console.log("正常登录"),this.first()):(console.log("链接进入"),this.mobile=c.globalData.mobile,this.getCompany(),this.getCompanyList())},onShow:function(){this.isLogin=c.globalData.isLogin,this.userInfo=c.globalData.userInfo},onShareAppMessage:function(){return{title:this.config.wxtitle}},onShareTimeline:function(){return{title:this.config.wxtitle}},methods:{toLogin:function(){t.navigateTo({url:"/pages/login/login"})},closeTip:function(){this.isShowTip=!1},toOffiaccount:function(){t.navigateTo({url:"/pages/web/web?url="+this.config.article_link})},toSearch:function(t){var o=this,n=t.detail.value;""==n?(this.searchList=[],this.isShowSearchList=!1):(this.searchCompany=[],this.$fn.searchCompany({keyword:n,mobile:this.mobile},(function(t){console.log(t.data),200==t.data.code?(o.searchList=t.data.data,o.isShowSearchList=!0):(o.searchList=[],o.isShowSearchList=!1)})))},selectCompany:function(t){var o=t.currentTarget.dataset.id;console.log(o),this.searchText=this.searchList[o].enterprise_name,this.searchCompany=this.searchList[o],this.isShowSearchList=!1,this.searchList=[]},toBind:function(){var o=this;t.showModal({title:"提示",content:"您确认要绑定这家公司吗",success:function(n){if(n.confirm){console.log("用户点击确定");var e=s(s({},o.searchCompany),{},{mobile:o.mobile});o.$fn.toBinding(e,(function(n){console.log(n),200==n.data.code&&t.showToast({icon:"success",title:"绑定成功",success:function(){o.searchCompany=[],o.searchList=[],o.searchText="",o.getCompanyList(),o.getCompany()}})}))}else n.cancel&&console.log("用户点击取消")}})},showExit:function(){this.isShowExit=!this.isShowExit},toSelect:function(){this.isShowSelect=!this.isShowSelect},companyChange:function(t){var o=t.detail.value;console.log("当前公司序号：",o),this.companyIndex=o},changeCompany:function(){console.log(this.companyIndex),null==this.companyIndex?t.showToast({title:"请选择一个公司",icon:"none"}):(t.setStorage({key:"nowCompany",data:this.companyList[this.companyIndex]}),this.nowCompany=this.companyList[this.companyIndex],this.isShowSelect=!1)},toDetail:function(){this.isLogin?(console.log(this.nowCompany.length),0==this.nowCompany.length?t.showToast({title:"请先查询并绑定企业",icon:"none"}):t.navigateTo({url:"/pages/detail/detail?id="+this.nowCompany.id})):t.navigateTo({url:"/pages/login/login"})},toOrder:function(){this.isLogin?t.navigateTo({url:"/pages/order/order"}):t.navigateTo({url:"/pages/login/login"})},getCompany:function(){var o=this;this.$fn.getCompany({mobile:this.mobile},(function(n){console.log(n.data.data),o.nowCompany=n.data.data,t.setStorage({key:"nowCompany",data:n.data.data})}))},getCompanyList:function(){var t=this;this.$fn.getCompanyList({mobile:this.mobile},(function(o){t.companyList=o.data.data}))},getConfig:function(){var t=this;this.$fn.getConfig({},(function(o){console.log(o.data.data),c.globalData.config=o.data.data,t.config=o.data.data,t.miniName=o.data.data.wxtitle,t.$fn.setTitle()}))},first:function(){var o=this;t.getStorage({key:"userInfo",success:function(n){console.log(n),void 0==n.data?(console.log("缓存没有信息"),o.$fn.getLogin((function(t){console.log(t.data.data),c.globalData.isLogin=!1,o.userInfo="",o.mobile="",o.isLogin=!1}))):(c.globalData.userInfo=n.data,c.globalData.mobile=n.data.mobile,c.globalData.access_token=n.data.access_token,c.globalData.isLogin=!0,o.userInfo=n.data,o.mobile=n.data.mobile,o.isLogin=!0,o.getCompanyList(),t.getStorage({key:"nowCompany",success:function(t){console.log(t),t.data.mobile==n.data.mobile?o.nowCompany=t.data:o.getCompany()},fail:function(){o.getCompany()}}))},fail:function(t){console.log("缓存没有信息"),o.$fn.getLogin((function(t){console.log(t.data.data),c.globalData.isLogin=!1,o.userInfo="",o.mobile="",o.isLogin=!1}))}})},logout:function(){var o=this;t.clearStorage({success:function(t){console.log(t),c.globalData.userInfo=[],c.globalData.isLogin=!1,c.globalData.mobile="",o.userInfo=[],o.isLogin=!1,o.nowCompany=[],o.isShowExit=!1},complete:function(t){console.log(t)}})}}};o.default=l}).call(this,n("543d")["default"])},"6de1":function(t,o,n){"use strict";n.r(o);var e=n("4e2e"),i=n.n(e);for(var a in e)["default"].indexOf(a)<0&&function(t){n.d(o,t,(function(){return e[t]}))}(a);o["default"]=i.a},"7bac":function(t,o,n){"use strict";var e=n("cb67"),i=n.n(e);i.a},a4ed:function(t,o,n){"use strict";n.d(o,"b",(function(){return e})),n.d(o,"c",(function(){return i})),n.d(o,"a",(function(){}));var e=function(){var t=this.$createElement,o=(this._self._c,this.isLogin?this.nowCompany.length:null),n=this.isLogin?this.companyList.length:null;this.$mp.data=Object.assign({},{$root:{g0:o,g1:n}})},i=[]},cb67:function(t,o,n){},e0ef:function(t,o,n){"use strict";(function(t,o){var e=n("4ea4");n("0e25");e(n("66fd"));var i=e(n("434e"));t.__webpack_require_UNI_MP_PLUGIN__=n,o(i.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])}},[["e0ef","common/runtime","common/vendor"]]]);